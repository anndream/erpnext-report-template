{% macro above_items_no_discount() %}
<div class="page-break">

        {% if letter_head and not no_letterhead %}
        <div class="letter-head">{{ letter_head }}</div>
        {% endif %}
     <div class="print-heading">
     
     <div class="col-xs-12 column-break text-right">
            <h2 >Quotation
                        </h2> </div>
               
    
            </div>
           
            <div class="row section-break">
                <div class="col-xs-6 column-break">
                        {% if doc.contact_person %}
                        <div class="row">
                                <div class="col-xs-3 text-right">
                                    <label>Contact</label>
                                </div>
                                <div class="col-xs-9 ">
                                    {{doc.contact_person}}
                                </div>
                            </div>
                        {%- endif -%}
                        {% if doc.contact_mobile %}
                        <div class="row">
                                <div class="col-xs-3 text-right">
                                    <label></label>
                                </div>
                                <div class="col-xs-9  text-left">
                                    {{doc.contact_mobile}}
                                </div>
                            </div>
                        {%- endif -%}

                        {% if doc.customer_name %}
                        <div class="row">
                                <div class="col-xs-3 text-right">
                                    <label>Customer</label>
                                </div>
                                <div class="col-xs-9  text-left">
                                    {{doc.customer_name}}
                                </div>
                            </div>
                        {%- endif -%}
                        
                        

                       
                        
                        {% if frappe.db.get_value("Address", customer, ["branch"]) %}
                            <div class="row">
                                    <div class="col-xs-3 text-right">
                                        <label>Branch</label>
                                    </div>
                                    <div class="col-xs-9  value">
                                       
                                 {{frappe.db.get_value("Address", customer, ["branch"])}}
     
                                    </div>
                                </div>
                        {%- endif -%}
                        {% if doc.tax_id %}
                                <div class="row">
                                        <div class="col-xs-3 text-right">
                                            <label>Tax ID</label>
                                        </div>
                                        <div class="col-xs-8  value">
                                            {{doc.tax_id}}
                                        </div>
                                    </div>
                        {%- endif -%}     
                             
                        {% if doc.address_display %}
                            <div class="row">
                                <div class="col-xs-3 text-right">
                                    <label>Address</label>
                                </div>
                                <div class="col-xs-9  value">
                                    {{doc.address_display}}
                                </div>
                            </div>
                        {%- endif -%}
                            
                        
                        
                </div>
                
                <div class="col-xs-6 column-break">
                        {% if doc.name %}
                        <div class="row">
                                <div class="col-xs-5 text-right">
                                    <label>Doc No</label>
                                </div>
                                <div class="col-xs-7  value">
                                    <label>{{doc.name}}</label>
                                </div>
                            </div>
                        {%- endif -%}
                        {% if doc.get_formatted("transaction_date") %}
                    <div class="row">
                        <div class="col-xs-5 text-right">
                            <label>Doc Date</label>
                        </div>
                        <div class="col-xs-7  value">
                           
                      <label> {{doc.get_formatted("transaction_date") }}</label>
                        </div>
                    </div>
                    {%- endif -%}

                    <div class="row">
                        <div class="col-xs-5 text-right">
                            <label>Valid Till</label>
                        </div>
                        <div class="col-xs-7  value">
                           
                      <label> {{doc.get_formatted("valid_till") }}</label>
                        </div>
                    </div>
                   

<br>

                    {% if doc.saleby %}
                    <div class="row">
                            <div class="col-xs-5 text-right">
                                <label>Sale Name</label>
                            </div>
                            <div class="col-xs-7  value">
                                

                           
{{ frappe.db.get_value("User", doc.saleby, ["full_name"])}}



                            </div>
                    </div>
                    {%- endif -%}
                    {% if doc.saleby %}
                    <div class="row">
                            <div class="col-xs-5 text-right">
                                <label>Tel</label>
                            </div>
                            <div class="col-xs-7  value">
                  
                        {{ frappe.db.get_value("User", doc.saleby, ["mobile_no"])}}        
                            </div>
                    </div>
                    {%- endif -%}
                    {% if doc.saleby %}
                    <div class="row">
                            <div class="col-xs-5 text-right">
                                <label>Email</label>
                            </div>
                            <div class="col-xs-7  value">
                                                           
			{{ frappe.db.get_value("User", doc.saleby, ["email"])}}
                            </div>
                    </div>
                    {%- endif -%}
                    
                </div>
            </div>
          
            <table class="table table-bordered">
                <tbody>
                    <tr>
                        <th>Item</th>
                        
                        <th class="text-center">Description</th>
                        <th class="text-center">Qty</th>
                        <th class="text-center">Price</th>

 
                        <th class="text-center">Amount</th>
                    </tr>

                    

{% endmacro %}



{% macro above_items_discount() %}
<div class="page-break">

        {% if letter_head and not no_letterhead %}
        <div class="letter-head">{{ letter_head }}</div>
        {% endif %}
     <div class="print-heading">
     
     <div class="col-xs-12 column-break text-right">
            <h2 >Quotation
                        </h2> </div>
               
    
            </div>
           
            <div class="row section-break">
                <div class="col-xs-6 column-break">
                        {% if doc.contact_person %}
                        <div class="row">
                                <div class="col-xs-3 text-right">
                                    <label>Contact</label>
                                </div>
                                <div class="col-xs-9 ">
                                    {{doc.contact_person}}
                                </div>
                            </div>
                        {%- endif -%}
                        {% if doc.contact_mobile %}
                        <div class="row">
                                <div class="col-xs-3 text-right">
                                    <label></label>
                                </div>
                                <div class="col-xs-9  text-left">
                                    {{doc.contact_mobile}}
                                </div>
                            </div>
                        {%- endif -%}

                        {% if doc.customer_name %}
                        <div class="row">
                                <div class="col-xs-3 text-right">
                                    <label>Customer</label>
                                </div>
                                <div class="col-xs-9  text-left">
                                    {{doc.customer_name}}
                                </div>
                            </div>
                        {%- endif -%}
                        
                        

                       
                        
                        {% if frappe.db.get_value("Address", customer, ["branch"]) %}
                            <div class="row">
                                    <div class="col-xs-3 text-right">
                                        <label>Branch</label>
                                    </div>
                                    <div class="col-xs-9  value">
                                       
                                 {{frappe.db.get_value("Address", customer, ["branch"])}}
     
                                    </div>
                                </div>
                        {%- endif -%}
                        {% if doc.tax_id %}
                                <div class="row">
                                        <div class="col-xs-3 text-right">
                                            <label>Tax ID</label>
                                        </div>
                                        <div class="col-xs-8  value">
                                            {{doc.tax_id}}
                                        </div>
                                    </div>
                        {%- endif -%}     
                             
                        {% if doc.address_display %}
                            <div class="row">
                                <div class="col-xs-3 text-right">
                                    <label>Address</label>
                                </div>
                                <div class="col-xs-9  value">
                                    {{doc.address_display}}
                                </div>
                            </div>
                        {%- endif -%}
                            
                        
                        
                </div>
                
                <div class="col-xs-6 column-break">
                        {% if doc.name %}
                        <div class="row">
                                <div class="col-xs-5 text-right">
                                    <label>Doc No</label>
                                </div>
                                <div class="col-xs-7  value">
                                    <label>{{doc.name}}</label>
                                </div>
                            </div>
                        {%- endif -%}
                        {% if doc.get_formatted("transaction_date") %}
                    <div class="row">
                        <div class="col-xs-5 text-right">
                            <label>Doc Date</label>
                        </div>
                        <div class="col-xs-7  value">
                           
                      <label> {{doc.get_formatted("transaction_date") }}</label>
                        </div>
                    </div>
                    {%- endif -%}

                    <div class="row">
                        <div class="col-xs-5 text-right">
                            <label>Valid Till</label>
                        </div>
                        <div class="col-xs-7  value">
                           
                      <label> {{doc.get_formatted("valid_till") }}</label>
                        </div>
                    </div>
                   

<br>

                    {% if doc.saleby %}
                    <div class="row">
                            <div class="col-xs-5 text-right">
                                <label>Sale Name</label>
                            </div>
                            <div class="col-xs-7  value">
                                

                           
{{ frappe.db.get_value("User", doc.saleby, ["full_name"])}}



                            </div>
                    </div>
                    {%- endif -%}
                    {% if doc.saleby %}
                    <div class="row">
                            <div class="col-xs-5 text-right">
                                <label>Tel</label>
                            </div>
                            <div class="col-xs-7  value">
                  
                        {{ frappe.db.get_value("User", doc.saleby, ["mobile_no"])}}        
                            </div>
                    </div>
                    {%- endif -%}
                    {% if doc.saleby %}
                    <div class="row">
                            <div class="col-xs-5 text-right">
                                <label>Email</label>
                            </div>
                            <div class="col-xs-7  value">
                                                           
			{{ frappe.db.get_value("User", doc.saleby, ["email"])}}
                            </div>
                    </div>
                    {%- endif -%}
                    
                </div>
            </div>
          
           <table class="table table-bordered">
                <tbody>
                    <tr>
                        <th>Item</th>
                        
                        <th class="text-center">Description</th>
                        <th class="text-center">Qty</th>
                        <th class="text-center">Price</th>

                        <th class="text-center">Discount</th>
                        <th class="text-center">Amount</th>
                    </tr>


{% endmacro %}


{% macro below_items() %}
</div>

{% endmacro %}

{% macro below_items2() %}
 <div class="row section-break">
                    <div class="col-xs-6 column-break">
                         {% if doc.amount %}
                        <div class="row">
                            <div class="col-xs-5 text-right">
                                <label>{{doc.amount}}</label>
                            </div>
                            
                        </div>
                          {%- endif -%}
                     </div>
                <div class="col-xs-6 column-break">

                     <div class="row">
                            <div class="col-xs-7 text-right">
                                <label>Discount</label>
                            </div>
                            <div class="col-xs-5 text-right value">
                                
    {{doc.get_formatted("discount_amount") }}
                            </div>
                    </div>
                                    <div class="row">
                            <div class="col-xs-7 text-right">
                                <label>Total</label>
                            </div>
                            <div class="col-xs-5 text-right value">
    
    {{doc.get_formatted("net_total") }}
                               
                            </div>
                        </div>
                      <div class="row">
                            <div class="col-xs-7 text-right">
                                <label>Vat7%</label>
                            </div>
                            <div class="col-xs-5 text-right value">
                                
    {{doc.get_formatted("total_taxes_and_charges") }}
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="col-xs-7 text-right">
                                <label>Grand Total</label>
                            </div>
                            <div class="col-xs-5 text-right value">
    {{doc.get_formatted("grand_total") }}
                               
                            </div>
                        </div>
                       
                </div>
            </div>
    <br>
    {% if doc.terms %}
    <div class="row section-break">
    <div class="col-xs-12 column-break">
     {{doc.terms}}
    </div>
    </div>

    {%- endif -%}
        
       
         <br>
            <div class="buttonBox">
        
                <table class="table table-condensed cart no-border">
                  
                    <colgroup>
                        <col class="col-xs-4"></col>
                        <col class="col-xs-4"></col>
                        <col class="col-xs-4"></col>
                    </colgroup>
                    <thead>
                    <tr>
                        <th style=" text-align: center;">Cutomer</th>
                        <th style=" text-align: center;">Approver</th>
                        <th style=" text-align: center;">Issue</th>
                    </tr>
                    </thead>
        
                    <tbody>
                    <tr>
                        <td style=" text-align: center; line-height: 1.8em;"></td>
                        <td style=" text-align: center; line-height: 1.8em;"></td>
                        <td style=" text-align: center; line-height: 1.8em;"></td>
                    </tr>
                    <tr>
                        <td style=" text-align: center; line-height: 1.8em;">__________________</td>
                        <td style=" text-align: center; line-height: 1.8em;"><div class="underscore">{{doc.approve_by}}</div></td>
        
                        <td style=" text-align: center; line-height: 1.8em;"><div class="underscore">{{frappe.db.get_value("User", frappe.session.user, ["full_name"])}}</div></td>
                    </tr>
                    <tr>
                        <td style=" text-align: center; line-height: 1.8em;">วันที่______/______/_______</td>
                        <td style=" text-align: center; line-height: 1.8em;">วันที่ {{doc.get_formatted("approve_date") }}</td>
                        <td style=" text-align: center; line-height: 1.8em;">วันที่ {{doc.get_formatted("transaction_date") }}</td>
                    </tr>
                    <tr height="40">
                            <td style=" text-align: center; line-height: 1.8em;">&nbsp;</td>
                            <td style=" text-align: center; line-height: 1.8em;">&nbsp;  </td>
                            <td style=" text-align: center; line-height: 1.8em;">&nbsp;</td>
                    </tr>
        
                    </tbody>
        
                     
                </table>
        
            </div>
        
        

   </div>

{% endmacro %}


 {% if  doc.show_discount_item %}
      
      {{ above_items_discount() }}


                    {%- for row in doc.items -%}
                        {% if row.idx % 12 == 0 %}
                                </table>

                                {%- if row.idx == doc.items|length -%}
                                    {{ below_items2() }}
                                {% else %}
                                    {{ below_items() }}
                                {%- endif %}

                                {{ above_items_discount() }}
                         {% endif %}

                    <tr>
                        <td style="width: 3%;">{{ row.idx }}</td>
                        
                        <td style="width: 37%;">
                            <div style="border: 0px;">{{ row.description }}</div></td>
                        <td style="width: 10%; text-align: right;">{{ row.qty }} {{ row.uom or row.stock_uom }}</td>
                        <td style="width: 15%; text-align: right;">{{
                            row.get_formatted("rate", doc) }}</td>

                        {% if  row.get_formatted("discount_percentage", doc) %}
                         <td style="width: 15%; text-align: right;">{{
                            row.get_formatted("discount_percentage", doc) }}</td>
                          {% else %}
                          <td style="width: 15%; text-align: right;"> 0 % </td>  
                        {%- endif -%}


                        <td style="width: 15%; text-align: right;">{{
                            row.get_formatted("amount", doc) }}</td>
                    </tr>
               
                   
                    {%- endfor -%}
                </tbody>
            </table>
             {{ below_items2() }}

    {% else %}

           {{ above_items_no_discount() }}
            
                    {%- for row in doc.items -%}
                        {% if row.idx % 12 == 0 %}
                                </table>

                                {%- if row.idx == doc.items|length -%}
                                    {{ below_items2() }}
                                {% else %}
                                    {{ below_items() }}
                                {%- endif %}

                                {{ above_items_no_discount() }}
                         {% endif %}


                    <tr>
                        <td style="width: 3%;">{{ row.idx }}</td>
                        
                        <td style="width: 37%;">
                            <div style="border: 0px;">{{ row.description }}</div></td>
                        <td style="width: 10%; text-align: right;">{{ row.qty }} {{ row.uom or row.stock_uom }}</td>
                        <td style="width: 15%; text-align: right;">{{
                            row.get_formatted("rate", doc) }}</td>                      
                        <td style="width: 15%; text-align: right;">{{
                            row.get_formatted("amount", doc) }}</td>
                    </tr>
               
                   
                    {%- endfor -%}
                </tbody>
            </table>

             {{ below_items2() }}


         {%- endif -%}


           